Code is messy and mostly uncommented.

Indentation is weird in github but notepad++ displays it correctly.
