Warning: code is messy lmfao
